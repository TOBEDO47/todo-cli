Refactored code and added comments (April 6)
